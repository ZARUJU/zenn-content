---
title: "Tauriã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å°å…¥ã™ã‚‹(tauri-plugin-sql)"
emoji: "ğŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["tauri"]
published: true
---

# ã¾ãˆãŒã

ç­†è€…ã¯ã€Rust ã«è©³ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚ã—ãŸãŒã£ã¦ã€Rust ã«ã¤ã„ã¦ã¯å‚è€ƒè¨˜äº‹æ§˜ã‚ˆã‚Šã‚³ãƒ”ãƒšã—ãŸã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚

# ãƒªãƒã‚¸ãƒˆãƒª

https://github.com/tauri-apps/tauri-plugin-sql

# å°å…¥

```bash:ã‚¿ãƒ¼ãƒŸãƒŠãƒ«
npm add https://github.com/tauri-apps/tauri-plugin-sql#v1
```

```toml:src-tauri/Cargo.toml
[dependencies.tauri-plugin-sql]
git = "https://github.com/tauri-apps/plugins-workspace"
branch = "v1"
features = ["sqlite"] # or "postgres", or "mysql"
```

# DB ã®ä½œæˆæ–¹æ³•

å®Ÿéš›ã«ã¯ã€ã“ã®å·¥ç¨‹ã§ SQL ã®ç™»éŒ²ãŒå®Œäº†ã—ã€å¾Œè¿°ã®ã€ŒDB ã®åˆ©ç”¨æ–¹æ³•ã€ã§ã®ãƒ­ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦ SQL ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

1. SQL ã®ä½œæˆ
2. `main.rs`ã§ã®èª­ã¿è¾¼ã¿

## SQL ã®ä½œæˆ

`src-tauri`å†…ã«`migrations`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€ãã®ä¸­ã«`.sql`ã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚

## `main.rs`ã§ã®èª­ã¿è¾¼ã¿

```sql:sample.sql
CREATE TABLE TODO(id INTEGER PRIMARY KEY, title TEXT)
```

```rust
fn main() {
    tauri::Builder::default()
    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç™»éŒ²
    .plugin(
        tauri_plugin_sql::Builder::default()
            .add_migrations(
                "sqlite:sample.db",  // ä½œæˆã™ã‚‹DBã®åå‰
                vec![tauri_plugin_sql::Migration {
                    version: 1,
                    description: "create todo table",
                    sql: include_str!("../migrations/sample.sql"),  // èª­ã¿è¾¼ã‚€SQLã®æŒ‡å®š
                    kind: tauri_plugin_sql::MigrationKind::Up,
                }],
            )
            .build(),
    )
    .run(tauri::generate_context!())
    .expect("error while running tauri application");
}
```

:::details è¤‡æ•°ã® SQL ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆ

```rust
fn main() {
    tauri::Builder::default()
        .invoke_handler(tauri::generate_handler![greet])
        // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç™»éŒ²
        .plugin(
            tauri_plugin_sql::Builder::default()
                .add_migrations(
                    "sqlite:sample.db",
                    vec![
                        tauri_plugin_sql::Migration {
                            version: 1,
                            description: "create table",
                            sql: include_str!("../migrations/sample1.sql"),
                            kind: tauri_plugin_sql::MigrationKind::Up,
                        },
                        tauri_plugin_sql::Migration {
                            version: 2,
                            description: "create table fro ver2",
                            sql: include_str!("../migrations/sample2.sql"),
                            kind: tauri_plugin_sql::MigrationKind::Up,
                        },
                    ],
                )
                .build(),
        )
        .run(tauri::generate_context!())
        .expect("error while running tauri application");
}
```

:::

# DB ã®åˆ©ç”¨æ–¹æ³•

## ãƒ­ãƒ¼ãƒ‰

ã“ã“ã§ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§ SQL ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

```ts
// sqlite. The path is relative to `tauri::api::path::BaseDirectory::App`.
const db = await Database.load("sqlite:sample.db");
// mysql
const db = await Database.load("mysql://user:pass@host/database");
// postgres
const db = await Database.load("postgres://postgres:password@localhost/sample");
```

## Execute

:::message alert
SELECT æ–‡ã‚’å®Ÿè¡Œã™ã‚‹éš›ã¯ã€`db.execute()`ã§ã¯ãªã`db.select()`å†…ã« SQL ã‚’æ›¸ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
:::

```ts:ãƒªãƒã‚¸ãƒˆãƒªã®README.mdã‚ˆã‚Š
// INSERT and UPDATE examples for sqlite and postgres
const result = await db.execute(
  "INSERT into todos (id, title, status) VALUES ($1, $2, $3)",
  [todos.id, todos.title, todos.status]
);

const result = await db.execute(
  "UPDATE todos SET title = $1, completed = $2 WHERE id = $3",
  [todos.title, todos.status, todos.id]
);

// INSERT and UPDATE examples for mysql
const result = await db.execute(
  "INSERT into todos (id, title, status) VALUES (?, ?, ?)",
  [todos.id, todos.title, todos.status]
);

const result = await db.execute(
  "UPDATE todos SET title = ?, completed = ? WHERE id = ?",
  [todos.title, todos.status, todos.id]
);
```

# å‚è€ƒ

- [TAURIÂ tauri-plugin-sql ã§ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ DB ã® TABLE ã‚’ä½œæˆã™ã‚‹æ–¹æ³• | Marock ã®ç‹¬ã‚Šè¨€](https://marock.tokyo/2023/05/07/tauri-tauri-plugin-sql%E3%81%A7%E3%83%9E%E3%82%A4%E3%82%B0%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E6%A9%9F%E8%83%BD%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6db%E3%81%AEtable%E3%82%92%E4%BD%9C/)
- [tauri-plugin-sql ã§ sqlite ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã©ã“ã«æ ¼ç´ã•ã‚Œã‚‹ã‹ï¼Ÿ - at backyard](https://shinshin86.hateblo.jp/entry/2022/07/14/065136)
